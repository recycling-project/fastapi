#도커파일 = 내 서버 실행환경 전체를 자동으로 구축해주는 설명서.
#그걸 이용해 어디서든 안정적으로 실행되게 만드는 기술.

# ============================
# 1) Python 3.11 베이스 이미지
# ============================
FROM python:3.11-slim

# ============================
# 2) 시스템 패키지 설치
# ============================
RUN apt-get update && apt-get install -y \
    build-essential \
    wget \
    git \
    libgl1 \
    libglib2.0-0 \
    && rm -rf /var/lib/apt/lists/*

# ============================
# 3) 작업 디렉토리 설정
# ============================
WORKDIR /app

# ============================
# 4) requirements.txt 복사 및 설치
# ============================
COPY requirements.txt .

RUN pip install --upgrade pip
RUN pip install -r requirements.txt

# ============================
# 5) FastAPI 코드 복사
# ============================
COPY . .

# ============================
# 6) 포트 노출 (Railway 자동 설정됨)
# ============================
EXPOSE 8000

# ============================
# 7) FastAPI 실행 명령
# ============================
CMD ["uvicorn", "app:app", "--host", "0.0.0.0", "--port", "8000"]
